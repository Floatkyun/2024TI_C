# 2024TI_C
## 整体方案概述   
系统通过 STM32F407ZGT6 单片机，控制 DDS 产生四路频率、相位相对独立的信号，分别为直达与多径传输 AM 信号的载波和调制信号，并可以独立控制其幅值和相移；单片机 DAC 提供直流偏置，通过加法器和乘法器得到调幅信号；之后通过运放电路将其放大到题目要求的幅值范围，多径传输信号外加 PE4302 程控衰减器调节额外衰减，最后通过加法器合路输出，整体结构框图如下    

![整体结构框图](https://github.com/Floatkyun/2024TI_C/blob/main/img/%E7%A1%AC%E4%BB%B6%E7%BB%93%E6%9E%84%E5%9B%BE.png)   

### 调幅波生成   
使用模拟乘法器、加法器，利用独立的载波和调制信号产生调幅波，使用单片机的DAC端口产生直流偏置，与DDS产生的调制信号经过加法器相加后，
通过 AD835 乘法器与 DDS 产生的载波相乘，即可得到调幅波。   
### 改变输出波形幅度   
对于直达传输信号，可以通过 DDS 直接产生幅度不同的直流偏置、
调制信号和载波来控制输出波形的幅度；对于多径传输信号，再通过程控衰减器PE4302 来控制其相对衰减；

## 系统软件设计分析   
软件系统结构框图如下图：   
![软件系统结构框图](https://github.com/Floatkyun/2024TI_C/blob/main/img/%E8%BD%AF%E4%BB%B6%E7%BB%93%E6%9E%84%E5%9B%BE.png)   

### 显示与交互界面   
由于本题需要修改的参数量多，不宜再用按键进行调整。所以我们为STM32F4移植了 8.3.10 版本的 LVGL 库，实现了操作界面的渲染与触控界面将在下面介绍，题目中的所有参数修改均可以通过下拉列表和滚轮控件进行设置，为人机交互提供了巨大的便利。   

#### CW波形设置界面   
通过此界面可以修改CW信号波形的幅度、频率和多径传输相关设置，点击`CHART0`或`CHART1`按钮来更换打表数据，长按`DEBUG`按钮进入开发者模式，此时可以对数据进行二次拟合。   
![CW波形设置界面](https://github.com/Floatkyun/2024TI_C/blob/main/img/LVGL_CW.png)    

#### AM波形设置界面   
通过此界面可以修改AM信号波形的幅度、频率和多径传输相关设置，点击`CHART0`或`CHART1`按钮来更换打表数据，长按`DEBUG`按钮进入开发者模式，此时可以对数据进行二次拟合。   
![AM波形设置界面](https://github.com/Floatkyun/2024TI_C/blob/main/img/LVGL_AM.png)  

#### 开发者模式界面 
